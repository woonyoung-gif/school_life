<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <title>ì•Œë¡ë‹¬ë¡ í•œì ì§ê¿ ì°¾ê¸°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- ê·€ì—¬ìš´ í°íŠ¸: ì£¼ì•„ì²´ & ë¶“ê¸€ì”¨ ëŠë‚Œ í°íŠ¸ -->
  <link href="https://fonts.googleapis.com/css2?family=Jua&family=Yeon+Sung&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg-gradient: radial-gradient(circle at center, #fff1eb 0%, #ace0f9 100%);

      /* í•œì ì¹´ë“œ ìƒ‰ìƒ (ë”°ëœ»í•œ ê³„ì—´) */
      --hanja-back: #ff9ff3;
      --hanja-front: #fff2cc;
      --hanja-border: #feca57;

      /* í•œê¸€ ì¹´ë“œ ìƒ‰ìƒ (ì‹œì›í•œ ê³„ì—´) */
      --hangul-back: #54a0ff;
      --hangul-front: #ffffff;
      --hangul-border: #48dbfb;

      --text-color: #2d3436;
    }

    * {
      box-sizing: border-box;
      user-select: none;
    }

    body {
      margin: 0;
      padding: 0;
      background-image: var(--bg-gradient);
      font-family: 'Jua', sans-serif;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow: hidden;
    }

    /* === í—¤ë” === */
    header {
      z-index: 10;
      width: 100%;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(255, 255, 255, 0.6);
      border-bottom: 2px solid #fff;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    h1 {
      margin: 0;
      font-size: 26px;
      color: #5f27cd;
      text-shadow: 2px 2px 0 #fff;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .score-board {
      font-size: 20px;
      color: #576574;
      display: flex;
      gap: 10px;
      font-weight: bold;
    }

    .badge {
      background: #fff;
      padding: 6px 14px;
      border-radius: 20px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      border: 2px solid #c8d6e5;
    }

    /* === ê²Œì„ ë³´ë“œ === */
    #game-container {
      position: relative;
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      padding: 20px;
      overflow-y: auto;
      /* í™”ë©´ ì‘ì„ ë•Œ ìŠ¤í¬ë¡¤ */
    }

    .grid {
      display: grid;
      gap: 12px;
      perspective: 1000px;
      max-width: 900px;
      width: 100%;
      margin: auto;
    }

    /* === ì¹´ë“œ ìŠ¤íƒ€ì¼ === */
    .card {
      background-color: transparent;
      aspect-ratio: 3/4;
      cursor: pointer;
      position: relative;
    }

    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
      transform-style: preserve-3d;
      border-radius: 16px;
      box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
    }

    /* ì¹´ë“œ ë’¤ì§‘í˜ íš¨ê³¼ */
    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card.matched .card-inner {
      transform: rotateY(180deg);
      box-shadow: 0 0 0 4px #00b894;
      animation: pop 0.4s;
    }

    /* ì•ë©´/ë’·ë©´ ê³µí†µ */
    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
      border-radius: 16px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      border: 4px solid white;
    }

    /* --- [1] ì¹´ë“œ ë’·ë©´ (ë’¤ì§‘ê¸° ì „) --- */
    .card-back {
      font-size: 14px;
      color: #fff;
    }

    /* í•œì ì¹´ë“œ ë’·ë©´: ë¶„í™ */
    .card.type-hanja .card-back {
      background: var(--hanja-back);
      background-image: repeating-linear-gradient(45deg, transparent 0, transparent 10px, rgba(255, 255, 255, 0.2) 10px, rgba(255, 255, 255, 0.2) 20px);
    }

    /* í•œê¸€ ì¹´ë“œ ë’·ë©´: í•˜ëŠ˜ */
    .card.type-mean .card-back {
      background: var(--hangul-back);
      background-image: radial-gradient(circle, rgba(255, 255, 255, 0.2) 20%, transparent 20%), radial-gradient(circle, rgba(255, 255, 255, 0.2) 20%, transparent 20%);
      background-position: 0 0, 10px 10px;
      background-size: 20px 20px;
    }

    .icon-label {
      font-size: 40px;
      margin-bottom: 5px;
      filter: drop-shadow(2px 2px 0 rgba(0, 0, 0, 0.1));
    }

    .text-label {
      font-weight: bold;
      font-size: 16px;
      text-shadow: 1px 1px 0 rgba(0, 0, 0, 0.1);
    }

    /* --- [2] ì¹´ë“œ ì•ë©´ (ë‚´ìš©) --- */
    .card-front {
      transform: rotateY(180deg);
      position: relative;
    }

    /* í•œì ì¹´ë“œ ì•ë©´ */
    .card.type-hanja .card-front {
      background: var(--hanja-front);
      border-color: var(--hanja-border);
      color: #d35400;
    }

    .hanja-char {
      font-family: 'Yeon Sung', cursive;
      /* ë¶“ê¸€ì”¨ì²´ */
      font-size: 55px;
      line-height: 1;
    }

    .tag {
      position: absolute;
      top: 5px;
      left: 5px;
      font-size: 12px;
      padding: 2px 8px;
      border-radius: 10px;
      color: #fff;
      font-weight: bold;
    }

    .card.type-hanja .tag {
      background: #ff9ff3;
    }

    /* í•œê¸€ ì¹´ë“œ ì•ë©´ */
    .card.type-mean .card-front {
      background: var(--hangul-front);
      border-color: var(--hangul-border);
      color: #2d3436;
    }

    .mean-text {
      font-size: 24px;
      word-break: keep-all;
      padding: 0 5px;
      text-align: center;
    }

    .card.type-mean .tag {
      background: #54a0ff;
    }

    /* ë°˜ì‘í˜• í°íŠ¸ í¬ê¸° ì¡°ì ˆ */
    @media (max-width: 600px) {
      .grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 8px;
      }

      .hanja-char {
        font-size: 40px;
      }

      .mean-text {
        font-size: 18px;
      }

      .icon-label {
        font-size: 30px;
      }
    }

    @media (min-width: 601px) {
      .grid {
        grid-template-columns: repeat(4, 1fr);
      }
    }

    /* === ì˜¤ë²„ë ˆì´ === */
    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(5px);
      z-index: 100;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .modal {
      background: #fff;
      padding: 30px;
      border-radius: 25px;
      text-align: center;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
      border: 5px solid #ff9ff3;
      max-width: 90%;
      animation: floatIn 0.5s ease-out;
    }

    .modal h2 {
      font-size: 32px;
      margin: 0 0 15px;
      color: #5f27cd;
    }

    .btn-group {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 20px;
    }

    button {
      font-family: 'Jua', sans-serif;
      font-size: 18px;
      padding: 12px 20px;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      color: #fff;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 4px 0 rgba(0, 0, 0, 0.1);
    }

    button:active {
      transform: translateY(2px);
      box-shadow: none;
    }

    button:hover {
      filter: brightness(1.1);
    }

    .btn-easy {
      background: linear-gradient(to bottom, #00b894, #00cec9);
    }

    .btn-norm {
      background: linear-gradient(to bottom, #0984e3, #74b9ff);
    }

    .btn-hard {
      background: linear-gradient(to bottom, #d63031, #ff7675);
    }

    .btn-restart {
      background: #6c5ce7;
      font-size: 22px;
      padding: 15px 40px;
      width: 100%;
    }

    @keyframes pop {
      0% {
        transform: rotateY(180deg) scale(1);
      }

      50% {
        transform: rotateY(180deg) scale(1.1);
      }

      100% {
        transform: rotateY(180deg) scale(1);
      }
    }

    @keyframes floatIn {
      from {
        transform: translateY(20px);
        opacity: 0;
      }

      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .hidden {
      display: none !important;
    }

    /* í­ì£½ ìº”ë²„ìŠ¤ */
    #confetti {
      position: fixed;
      top: 0;
      left: 0;
      pointer-events: none;
      z-index: 200;
    }
  </style>
</head>

<body>

  <header>
    <h1>
      <a href="index.html" style="text-decoration:none; margin-right:10px;">ğŸ”™</a>
      ğŸ“ í•œì ì§ê¿ ì°¾ê¸°
    </h1>
    <div class="score-board">
      <div class="badge">ë„ì „: <span id="moves">0</span></div>
      <div class="badge">ì„±ê³µ: <span id="pairs">0</span>/<span id="total-pairs">0</span></div>
    </div>
  </header>

  <div id="game-container">
    <div class="grid" id="grid">
      <!-- ì¹´ë“œ ìƒì„± ì˜ì—­ -->
    </div>
  </div>

  <!-- ì‹œì‘ í™”ë©´ -->
  <div id="start-screen" class="overlay">
    <div class="modal">
      <h2>í•œì ê³µë¶€ ì¤€ë¹„ëë‚˜ìš”?</h2>
      <p style="color: #636e72; line-height: 1.6;">
        <span style="color:#ff9ff3; font-weight:bold;">ë¶„í™ìƒ‰(í•œì)</span> ì¹´ë“œì™€<br>
        <span style="color:#54a0ff; font-weight:bold;">í•˜ëŠ˜ìƒ‰(í•œê¸€)</span> ì¹´ë“œë¥¼<br>
        í•˜ë‚˜ì”© ë’¤ì§‘ì–´ì„œ ì§ì„ ë§ì¶°ë³´ì„¸ìš”!
      </p>
      <div class="btn-group">
        <button class="btn-easy" onclick="initGame(1)">ğŸ£ 8ê¸‰ (ê¸°ì´ˆ)</button>
        <button class="btn-norm" onclick="initGame(2)">ğŸ¥ 7ê¸‰ (ë³´í†µ)</button>
        <button class="btn-hard" onclick="initGame(3)">ğŸ¦… ë„ì „ (ì–´ë ¤ì›€)</button>
      </div>
    </div>
  </div>

  <!-- ì„±ê³µ í™”ë©´ -->
  <div id="success-screen" class="overlay hidden">
    <div class="modal">
      <h2>ğŸŠ ì™€! ì§ì§ì§! ğŸŠ</h2>
      <p id="result-msg" style="font-size: 20px; color: #2d3436; margin-bottom: 20px;"></p>
      <button class="btn-restart" onclick="showStartScreen()">ë‹¤ì‹œ í•˜ê¸°</button>
    </div>
  </div>

  <canvas id="confetti"></canvas>

  <script>
    // === í•œì ë°ì´í„° ===
    const HANJA_DATA = {
      1: [ // 8ê¸‰ ê¸°ì´ˆ
        { hanja: "æ—¥", mean: "ë‚  ì¼" },
        { hanja: "æœˆ", mean: "ë‹¬ ì›”" },
        { hanja: "ç«", mean: "ë¶ˆ í™”" },
        { hanja: "æ°´", mean: "ë¬¼ ìˆ˜" },
        { hanja: "æœ¨", mean: "ë‚˜ë¬´ ëª©" },
        { hanja: "é‡‘", mean: "ì‡  ê¸ˆ" }, // í† , ê¸ˆ ì¶”ê°€
        { hanja: "åœŸ", mean: "í™ í† " },
        { hanja: "å±±", mean: "ë©” ì‚°" }
      ],
      2: [ // 7ê¸‰ ê¸°ì´ˆ
        { hanja: "éŸ“", mean: "í•œêµ­ í•œ" },
        { hanja: "åœ‹", mean: "ë‚˜ë¼ êµ­" },
        { hanja: "å­¸", mean: "ë°°ìš¸ í•™" },
        { hanja: "æ ¡", mean: "í•™êµ êµ" },
        { hanja: "ç‹", mean: "ì„ê¸ˆ ì™•" },
        { hanja: "æ°‘", mean: "ë°±ì„± ë¯¼" },
        { hanja: "è»", mean: "êµ°ì‚¬ êµ°" },
        { hanja: "é‚‘", mean: "ê³ ì„ ì" },
        { hanja: "å…„", mean: "í˜• í˜•" },
        { hanja: "å¼Ÿ", mean: "ì•„ìš° ì œ" }
      ],
      3: [ // ë„ì „
        { hanja: "å¤©", mean: "í•˜ëŠ˜ ì²œ" },
        { hanja: "åœ°", mean: "ë•… ì§€" },
        { hanja: "æ˜¥", mean: "ë´„ ì¶˜" },
        { hanja: "å¤", mean: "ì—¬ë¦„ í•˜" },
        { hanja: "ç§‹", mean: "ê°€ì„ ì¶”" },
        { hanja: "å†¬", mean: "ê²¨ìš¸ ë™" },
        { hanja: "æ±", mean: "ë™ë…˜ ë™" },
        { hanja: "è¥¿", mean: "ì„œë…˜ ì„œ" },
        { hanja: "å—", mean: "ë‚¨ë…˜ ë‚¨" },
        { hanja: "åŒ—", mean: "ë¶ë…˜ ë¶" },
        { hanja: "å¤§", mean: "í° ëŒ€" },
        { hanja: "å°", mean: "ì‘ì„ ì†Œ" }
      ]
    };

    // === ìƒíƒœ ë³€ìˆ˜ ===
    let flippedCards = [];
    let matchedCount = 0;
    let moveCount = 0;
    let isLocked = false;
    let totalPairs = 0;

    // DOM
    const grid = document.getElementById('grid');
    const movesEl = document.getElementById('moves');
    const pairsEl = document.getElementById('pairs');
    const totalPairsEl = document.getElementById('total-pairs');
    const startScreen = document.getElementById('start-screen');
    const successScreen = document.getElementById('success-screen');

    function showStartScreen() {
      successScreen.classList.add('hidden');
      startScreen.classList.remove('hidden');
      stopConfetti();
    }

    function initGame(level) {
      const data = HANJA_DATA[level];
      totalPairs = data.length;
      matchedCount = 0;
      moveCount = 0;
      flippedCards = [];
      isLocked = false;

      movesEl.innerText = 0;
      pairsEl.innerText = 0;
      totalPairsEl.innerText = totalPairs;
      startScreen.classList.add('hidden');

      // ì¹´ë“œ ë± ìƒì„± (íƒ€ì… êµ¬ë¶„)
      let deck = [];
      data.forEach((item, index) => {
        // 1. í•œì ì¹´ë“œ
        deck.push({ id: index, type: 'hanja', content: item.hanja });
        // 2. í•œê¸€ ì¹´ë“œ
        deck.push({ id: index, type: 'mean', content: item.mean });
      });

      // ì…”í”Œ
      deck.sort(() => Math.random() - 0.5);

      // ê·¸ë¦¬ë“œ ì„¤ì •
      grid.innerHTML = '';
      // ì¹´ë“œ ê°œìˆ˜ì— ë”°ë¼ ê·¸ë¦¬ë“œ ì»¬ëŸ¼ ìë™ ì¡°ì •
      if (level === 3) { // 24ì¥
        grid.style.gridTemplateColumns = window.innerWidth > 600 ? "repeat(6, 1fr)" : "repeat(4, 1fr)";
      } else if (level === 2) { // 20ì¥
        grid.style.gridTemplateColumns = window.innerWidth > 600 ? "repeat(5, 1fr)" : "repeat(4, 1fr)";
      } else { // 16ì¥
        grid.style.gridTemplateColumns = window.innerWidth > 600 ? "repeat(4, 1fr)" : "repeat(4, 1fr)";
      }

      // ì¹´ë“œ DOM ìƒì„±
      deck.forEach(cardData => {
        const cardEl = document.createElement('div');
        cardEl.className = `card type-${cardData.type}`;
        cardEl.dataset.id = cardData.id;

        // ì•ë©´ ë‚´ìš© êµ¬ì„± (íƒ€ì…ë³„ ë‹¤ë¦„)
        let frontContent = '';
        if (cardData.type === 'hanja') {
          frontContent = `
          <div class="tag">í•œì</div>
          <div class="hanja-char">${cardData.content}</div>
        `;
        } else {
          frontContent = `
          <div class="tag">ëœ»Â·ìŒ</div>
          <div class="mean-text">${cardData.content}</div>
        `;
        }

        // ë’·ë©´ ë‚´ìš© êµ¬ì„± (íƒ€ì…ë³„ ìƒ‰ìƒ/ì•„ì´ì½˜ ë‹¤ë¦„)
        let backContent = '';
        if (cardData.type === 'hanja') {
          backContent = `
          <div class="icon-label">ğŸ”´</div>
          <div class="text-label">í•œì</div>
        `;
        } else {
          backContent = `
          <div class="icon-label">ğŸ”µ</div>
          <div class="text-label">í•œê¸€</div>
        `;
        }

        cardEl.innerHTML = `
        <div class="card-inner">
          <div class="card-face card-back">${backContent}</div>
          <div class="card-face card-front">${frontContent}</div>
        </div>
      `;

        cardEl.addEventListener('click', () => flipCard(cardEl));
        grid.appendChild(cardEl);
      });
    }

    function flipCard(card) {
      if (isLocked || card.classList.contains('flipped') || card.classList.contains('matched')) return;

      card.classList.add('flipped');
      flippedCards.push(card);

      if (flippedCards.length === 2) {
        moveCount++;
        movesEl.innerText = moveCount;
        checkMatch();
      }
    }

    function checkMatch() {
      isLocked = true;
      const [card1, card2] = flippedCards;
      const match = card1.dataset.id === card2.dataset.id;

      if (match) {
        matchedCount++;
        pairsEl.innerText = matchedCount;
        card1.classList.add('matched');
        card2.classList.add('matched');
        flippedCards = [];
        isLocked = false;

        if (matchedCount === totalPairs) {
          setTimeout(gameClear, 600);
        }
      } else {
        setTimeout(() => {
          card1.classList.remove('flipped');
          card2.classList.remove('flipped');
          flippedCards = [];
          isLocked = false;
        }, 1000);
      }
    }

    function gameClear() {
      const msg = document.getElementById('result-msg');
      msg.innerHTML = `ì´ <b>${moveCount}</b>ë²ˆ ë§Œì—<br>ëª¨ë“  ì§ê¿ì„ ì°¾ì•˜ì–´ìš”!`;
      successScreen.classList.remove('hidden');
      startConfetti();
    }

    // === í­ì£½ íš¨ê³¼ ===
    const canvas = document.getElementById("confetti");
    const ctx = canvas.getContext("2d");
    let confettiParticles = [];
    let animationId = null;

    function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    function startConfetti() {
      confettiParticles = [];
      const colors = ['#fab1a0', '#ffeaa7', '#81ecec', '#74b9ff', '#a29bfe'];
      for (let i = 0; i < 200; i++) {
        confettiParticles.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height - canvas.height,
          r: Math.random() * 6 + 2,
          d: Math.random() * 200 + 10,
          color: colors[Math.floor(Math.random() * colors.length)],
          tilt: Math.floor(Math.random() * 10) - 10,
          tiltAngleIncremental: Math.random() * 0.07 + 0.05,
          tiltAngle: 0
        });
      }
      animateConfetti();
    }

    function stopConfetti() {
      if (animationId) cancelAnimationFrame(animationId);
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    function animateConfetti() {
      animationId = requestAnimationFrame(animateConfetti);
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let i = 0; i < confettiParticles.length; i++) {
        let p = confettiParticles[i];
        ctx.beginPath();
        ctx.lineWidth = p.r;
        ctx.strokeStyle = p.color;
        ctx.moveTo(p.x + p.tilt + p.r / 2, p.y);
        ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r / 2);
        ctx.stroke();
        p.y += 3;
        p.tiltAngle += p.tiltAngleIncremental;
        p.tilt = Math.sin(p.tiltAngle) * 15;
        if (p.y > canvas.height) { p.y = -20; p.x = Math.random() * canvas.width; }
      }
    }
  </script>
</body>

</html>